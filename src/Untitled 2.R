p<-read.csv("Dane1.csv", TRUE, "\t")
p<-read.table(Users/Emergence/Desktop/PRAKTYKI/Dane1.csv)
p<-c(105548,67683,281708,709913,1051189,374838,370857,432237,421068,355522,177593,63387,131050,116902,74965,84167,191624,93451,90927,76940,64651,74410,73696,76767,122804,13714,1074,27110,37434,61344,20813,4487,51841,12112,41921,13847,7291,10053,29892,80995,16210,37015,18918,58300,84456,16525,7179,22732,4627,15674,33034,59034,10445,7722,5461,14420,19797,10375,6167,5720,2749,1412,10601,6790,9694,63816,14259)
q<-c(1,2,	3,	4,	5,	6,	7,	8,	9,	10,	11,	12,	13,	14,	15,	16,	17,	18,	19,	20,	21,	22,	23,	24,	25,	26,	27,	28,	29,	30,	31,	32,	33,	37,	38,	39,	40,	41,	42,	44, 46,	47,	50,	51,	52,	53,	55,	56,	58,	59,	60,	61,	63,	64,	72,	73,	82,	95,	100,	112,	123,	132,	134,	157,	158,	159,	161)
r<-c(105548,	173231,	454939,	1164852,	2216042,	2590880,	2961736,	3393974,	3815041,	4170564,	4348157,	4411544,	4542594,	4659496,	4734461,	4818628,	5010252,	5103703,	5194630,	5271570,	5278576,	5352985,	5426681,	5503448,	5621759,	5635473,	5636546,	5663656,	5682331,	5743675,	5764488,	5768975,	5820816,	5816957,	5858878,	5857840,	5865131,	5875183,	5905075,	5986070,	6002281,	6039296,	6052001,	6110300,	6194757,	6211282,	6218461,	6241193,	6245820,	6261493,	6294527,	6350616,	6361061,	6368784,	6222873,	6235254,	6112234,	6019888,	5905422,	5695391,	5669882,	5589666,	5575694,	4839081,	4848775,	4887074,	4901334)
t<-c(729383122388157,	875259746865788,	1000296853560900,	1111440948401000,	1212481034619270,	1385692610993460,	1467203941051890,	1676804504059310,	2012165404871170,	2166947359092030,	2355377564230470,	2488700822583130,	2799788425406020,	2981592868614210,	3120271606689290,	3345445846347280,	3527924710693490,	3701429204662030,	4018694565061630,	4243342087332150,	4316926054164500,	4549018852775500,	4769845010677220,	5000982874630740,	5123957863351170,	5204650113167720,	5264473677686890,	5362326348275870,	5420402084899790,	5477862177672580,	5590420989542570,	5627690462806180,	5737320796497210,	5827247454749520,	5933197408472240,	5968305085445450,	6020506004560130,	6037856165956560,	6089461774212600,	6140633721895060,	6224751992058000,	6340330941512660,	6437874494459010,	6454090803009280,	6502375771610350,	6550304831351950,	6597885738117220,	6707070608487950,	6738121861305030,	6814865846057930,	6920639817061050,	6995376748130820,	7069323648216770,	7084082152701560,	7113476684455510,	7157296869370020,	7200850400015280,	7244142085786910,	7258543958720880,	7272917313094580,	7329959801824740,	7344192733478770,	7386644714597140,	7442816917749970,	7456833522114850,	7470823828910560,	7498700037227390,	7512612282194420,	7554118427399920,	7595397763068770,	7622817971599700,	7650139899813320,	7717840252909010,	7731356610619890,	7758295135395570,	7771741054174420,	7785163750295620,	7811916890330990,	7838578722721200,	7851887005781850,	7865172770597050,	7878436131087090,	7891677200214970,	7904896089997570,	7944354805921020,	7957485970889490,	7970595502966740,	7983683508718730,	7996750093839390,	8035758630882510,	8048740470350820,	8074620664789240,	8100418174900390,	8113296423191170,	8151748065007240,	8202696490413540,	8215413849313400,	8228111552326250,	8253428818641100,	8266068066449130,	8278688017695610,	8303851203159740,	8316413761712170,	8328957372212490,	8366418949598750,	8391319005996370,	8403750589708960,	8416163810668640,	8428558750006890,	8440935488259470,	8453294105372590,	8465634680708900,	8490244083850490,	8514782361549480,	8527033846961780,	8539267754920120,	8563665662791320,	8575847264018620,	8600141448902520,	8612271408632990,	8624384307941900,	8648542247179830,	8660604370258190,	8672649717087470,	8684678357471780,	8696690360732460,	8708685795712780,	8720664730782540,	8732627233842600,	8756486871093530,	8768400458673250,	8803996130359340,	8839448463770190,	8851250130611000,	8874790689469010,	8886545379123930,	8909992728409220,	8945025465218170,	8956687819149350,	8968335007470750,	8979967089192500,	8991584122943070,	9003186166972670,	9014773279156680,	9026345516998990,	9037902937635350,	9049445597836670,	9072530918239310,	9095616238641960,	9118701559044600,	9141786879447250,	9164872199849890,	9187957520252540,	9211042840655180,	9234128161057830,	9257213481460470,	9280298801863110,	9303384122265760,	9326469442668400,	9349554763071050,	9372640083473690,	9395725403876330,	9418810724278980,	9441896044681620,	9511152005889560,	9580407967097490,	9603493287500140,	9626578607902780,	9649663928305430,	9672804609188660,	9696168871529690,	9719533133870730,	9743124233710220,	9766772593500780,	9790420953291340,	9814417083078820,	9839326771106940,	9864685860723190,	9890110308817840,	9917355791762240,	9944827691462410,	9972375690607740,	10000000000000000)
s<-c(162133561273721,	266103202120797,	698840097251343,	1789349675899130,	3404099340349050,	3979894740563870,	4549573768115770,	5213540643986240,	5860350060039190,	6406474145688490,	6679277921151670,	6776647343183960,	6977955637638590,	7157531147609530,	7272685978752700,	7401976927149650,	7696333454176970,	7839885298616560,	7979559891427180,	8097748123653030,	8198157851036200,	8313723275776780,	8428179864481730,	8547407468920200,	8738290967090230,	8759607031580110,	8761276129150840,	8803414683622440,	8861793835159800,	8957462296252480,	8989921601000830,	8996918610947950,	9077766560952270,	9096707589358560,	9162265314850220,	9183974766536760,	9195404941007670,	9211165686234670,	9258030696575670,	9385014965933570,	9410429699099370,	9468462730562800,	9498153670259170,	9589650495760030,	9722198268163620,	9748133608150570,	9759399889368970,	9795076548573120,	9802337989892110,	9826936494705990,	9878780902525880,	9971474285921730,	9987874968777400,	10000000000000000,	10008783413716900,	10031983801053300,	10064581357469200,	10081957934099100,	10092497782260800,	10102644468768400,	10107545571949600,	10110100342648900,	10129359079368800,	10143592530154500,	10163913606908700,	10298390436440500,	10328438646500400)
p<-s/10000000000000000
quantile(p, 1/3)
mean(p)
var(p)
qqplot(q*7,r)
length(p)
plot(q*7, p)
hist(p)
plot(ecdf(p))
plot(ecdf(1-r))
hist(r)
plot(q*7,1-p)
?plot
length(p)
length(r)
x<-q
y<-r
#######
time<-q
sales<-r
plot(time, sales)
model <- lm(sales ~ time)
d <- data.frame(time, sales)
model <- lm(sales ~ time, d)
model

plot(d$time, d$sales, pch = 20, cex = 1.5)
abline(model, col = "red", lwd = 2)

summary(model)$r.squared

plot(d$time, d$sales)
abline(model)
text(mean(d$time), mean(d$sales), round(summary(model)$r.squared, 3), pos = 4)
model.coef <- round(coef(model), 3)
mtext(bquote(y == .(model.coef[2]) * x + .(model.coef[1])), adj = 1, padj = 0)

time.pred <- 161:191  # prognozujemy na kolejne 4 miesiÄ…ce
sales.pred <- predict(model, data.frame(time = time.pred))

d.pred <- data.frame(time = time.pred, sales = sales.pred)

d.2 <- rbind(d, d.pred)
plot(d.2$time, d.2$sales)

add.linear.trend <- function(x, y, x.pred) 
  {
  model <- lm(y ~ x)
  
  y.pred <- predict(model, data.frame(x = x.pred))
  
  plot(x, y, xlim = range(c(x, x.pred)), ylim = range(c(y, y.pred)), pch = 20, 
       cex = 1.5)
  abline(model, col = "red", lwd = 1.5)
  points(x.pred, y.pred, pch = 1, cex = 1.5)
  
  list(coefs = coef(model), r.squared = summary(model)$r.squared, y.y.pred = c(y, 
                                                                               y.pred))
}
add.linear.trend2(q,p,161:191)

add.linear.trend2 <- function(x, y, x.pred) {
  
  model <- nls(sales ~ a * time^5 + b * time^4 + c * time^3 + e * time^2 + f * time + g, d, start = list(a = 1, b = 1, c = 1, e = 1, f = 1, g = 0))
  
  y.pred <- predict(model, data.frame(x = x.pred))
  
  plot(x, y, xlim = range(c(x, x.pred)), ylim = range(c(y, y.pred)), pch = 20, cex = 1.5)
  abline(model, col = "red", lwd = 1.5)
  points(x.pred, y.pred, pch = 1, cex = 1.5)
  
  list(coefs = coef(model), r.squared = summary(model)$r.squared, y.y.pred = c(y, y.pred))
}

####
d.2 <- d
d.2$time.2 <- d.2$time^2
d.2$time.3 <- d.2$time^3
d.2$time.4 <- d.2$time^4
d.2$time.5 <- d.2$time^5

(model <- lm(sales ~ time.5 + time.4 + time.3 + time.2 + time, d.2))

lines(q,r,col='firebrick1',lwd=1)
noise <- rnorm(length(q), mean=10, sd=80)
noisy.y <- y + noise
model <- lm(noisy.y ~ poly(q,5))
confint(model, level=0.95)
plot(fitted(model),residuals(model))
predicted.intervals <- predict(model,data.frame(x=q),interval='confidence', level=0.99)
lines(q,predicted.intervals[,1],col='green',lwd=3)
lines(q,predicted.intervals[,2],col='black',lwd=1)
lines(q,predicted.intervals[,3],col='black',lwd=1)
legend("bottomright",c("Observ.","Signal","Predicted"), col=c("deepskyblue4","red","green"), lwd=3)

####
lm(1-y ~ poly(x, 5, raw=TRUE))


######
b<-ecdf(p)
View(b)


install.packages("data.table")
install.packages("mltools")
library(data.table)
library(mltools)
dt <- data.table(x=q, y=p)
?empirical_cdf
e<-empirical_cdf(dt$x, ubounds=seq(1, 161, by=1.0))
ggplot(e)
f<-empirical_cdf(dt, ubounds=list(x=seq(1, 161, by=1.0)))
empirical_cdf(dt, ubounds=list(x=seq(1, 67, by=1.0), y=seq(1, 67, by=1.0)))
View(e)
View(f)
a<-e[,3]
a<-a*10000000000
View(a)

install.packages("ggplot2")
library(ggplot2)
cdf <- ggplot (data=ecdf(r)) 
cdf
?stat_ecdf

install.packages(sm)
# Michal Ramsza
# 24 Dec 2006

# Przykladowe podstawowe wykresy

library(sm) # implementacja pause()

# Podstawowe wykresy
n <- 10^3
x.data <- q
y.data <- p
x.bound <- 5
x.reg <- c(-x.bound, x.bound)
x.points <- seq(-x.bound, x.bound, 0.1)
x.density <- density(x.data,kernel="epanechnikov")

# Dystrybuanty empiryczne
par( mfrow=c(1,1))
x.data.part <- x.data[1:length(q)]
n.part <- length(x.data.part)
plot(sort(x.data.part), 1:n.part/n.part, type="s", col="red", main="Empirical CDF", xlab="x", ylab="probability")
points(sort(x.data.part), 1:n.part/n.part, pch=20, col="blue")
lines( sort(x.data.part), 1:n.part/n.part, 0, 1)
grid()


